<style>
  /* Responsive input fields for mobile */
  input[type="number"] {
    min-width: 120px;
    width: 100%;
    max-width: 400px;
    box-sizing: border-box;
    font-size: 1.1em;
    padding: 0.2em;
    margin-top: 0.2em;
    margin-bottom: 0.6em;
  }
  label {
    display: block;
    margin-bottom: 0.2em;
  }
  @media (max-width: 600px) {
    div[style*="font-family:monospace;"] {
      font-size: 1em;
    }
    input[type="number"] {
      font-size: 1.2em;
      min-width: 120px;
      max-width: 100%;
    }
  }
</style>

<!-- Einleitung und Beschreibung -->
<div style="font-family:monospace; margin-bottom:2em;">
  <h2>Miet- und Kaufrechner</h2>
  <p>
    Diese Webseite ist ein Versuch, verschiedene Mietkosten- und Immobilienkauf-Szenarien zu berechnen.<br>
    Die Interpretation der Ergebnisse bleibt dir überlassen.<br>
  </p>
</div>
<!-- Financial Input Parameters and Index Calculation -->
<div style="font-family:monospace;">
  <h3>Berechnung des Preis-Einkommens-Index & des Vervielfältiger-Index - Ohne Dynamik</h3>
  <p>
    Preis-Einkommens-Index (Kaufpreis/Jahresnettoeinkommen): <br> 
    Gibt an, wie viele Jahresnettoeinkommen benötigt werden, um den Kaufpreis der Immobilie zu decken. <br>
     <br>
    Vervielfältiger-Index: <br>
    Gibt an, wie viele Jahreskaltmieten dem Kaufpreis der Immobilie entsprechen.
  </p>
  <label>
    Kaufpreis der Immobilie [€]:
    <input type="number" id="housing_cost" value="500000" min="0" step="1" style="width:8em;">
  </label><br>
  <label>
    Jah­res­net­to­ein­kom­men [€]:&nbsp;&nbsp;&nbsp;
    <input type="number" id="netto_income_per_anno" value="20000" min="0" step="1" style="width:8em;">
  </label><br>
  <label>
    Monatskaltmiete [€]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="cold_rent_per_month" value="1000" min="0" step="1" style="width:8em;">
  </label><br><br>
  <div id="finanz-parameter"></div>
  <div id="index"></div>
  <div id="vervielfaeltiger"></div>
</div>

<script>
  function updateOutput() {
    const housing_cost = Number(document.getElementById('housing_cost').value);
    const netto_income_per_anno = Number(document.getElementById('netto_income_per_anno').value);
    const cold_rent_per_month = Number(document.getElementById('cold_rent_per_month').value);

    const index = netto_income_per_anno > 0 ? (housing_cost / netto_income_per_anno).toFixed(2) : '—';
    document.getElementById('index').innerHTML = `<br>Preis-Einkommens-Index (Kaufpreis / Jahresnettoeinkommen):&nbsp;${index}`;

    const vervielfaeltiger = cold_rent_per_month > 0 ? (housing_cost / (cold_rent_per_month * 12)).toFixed(2) : '—';
    document.getElementById('vervielfaeltiger').innerHTML = `Vervielfältiger-Index (Kaufpreis / Jahreskaltmiete): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${vervielfaeltiger}`;
  }

  // Initial output
  updateOutput();

  // Add event listeners
  document.getElementById('housing_cost').addEventListener('input', updateOutput);
  document.getElementById('netto_income_per_anno').addEventListener('input', updateOutput);
  document.getElementById('cold_rent_per_month').addEventListener('input', updateOutput);
</script>

<div style="font-family:monospace; margin-bottom:2em;">
<p>
  Und was sagen mir diese Indizes? <br>
  Die empirica AG veröffentlicht quartalsweise einen 
  <a href="https://www.empirica-institut.de/fileadmin/Redaktion/Publikationen_Referenzen/PDFs/Blasenindex__2025Q1.pdf" target="_blank" rel="noopener">
    Immobilien Blasenindex (Q12025)
  </a> für Deutschlands Großstädte. <br>
  Hier kannst du die Indizes vergleichen und dich davor schützen, dass du einen zu hohen Preis zahlst.<br>
</p>
</div>


<!-- Visuelle Trennung -->
<hr style="margin: 2em 0; border: 0; border-top: 2px dashed #888;">


<!-- Gesamte Mietzahlungen über X Jahre (mit und ohne Steigerung) -->
<div style="font-family:monospace;">
  <h3>Gesamte Mietzahlungen</h3>
  <p>
    Diese Berechnung zeigt die gesamten Mietzahlungen über einen bestimmten Zeitraum, sowohl ohne als auch mit jährlicher Mietsteigerung.
  </p>
  <label>
    Monatsmiete [€]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="miete_monat" value="1000" min="0" step="1" style="width:4em;">
  </label><br>
  <label>
    Zeitraum [Jahre]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="miete_zeitraum" value="10" min="1" max="50" step="1" style="width:4em;">
  </label><br>
  <label>
    Mietsteigerung pro Jahr [%]:
    <input type="number" id="miete_steigerung" value="2" min="0" max="10" step="0.1" style="width:4em;">
  </label>
  <br><br>
  <div id="miete-kaltmiete-in-n-jahren"></div>
  <div id="miete-ohne-steigerung"></div>
  <div id="miete-mit-steigerung"></div>
</div>

<script>
function updateMiete() {
  // Input-Parameter
  const cold_rent_per_month = Number(document.getElementById('miete_monat').value);
  const zeitraum = Number(document.getElementById('miete_zeitraum').value);
  const average_rent_increase_rate = Number(document.getElementById('miete_steigerung').value) / 100;

  // Jahresmiete
  const miete = cold_rent_per_month * 12;

  // Kaltmiete in n Jahren
  const kaltmiete_in_n_jahren = cold_rent_per_month * Math.pow(1 + average_rent_increase_rate, zeitraum);

  // Gesamte Mietzahlungen ohne Steigerung
  const miete_ohne_steigerung = miete * zeitraum;

  // Gesamte Mietzahlungen mit Steigerung
  let miete_mit_steigerung = 0;
  for (let i = 0; i < zeitraum; i++) {
    miete_mit_steigerung += miete * Math.pow(1 + average_rent_increase_rate, i);
  }

  document.getElementById('miete-kaltmiete-in-n-jahren').innerHTML =
    `Kaltmiete in ${zeitraum} Jahren: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ${kaltmiete_in_n_jahren.toLocaleString('de-DE', {maximumFractionDigits: 2})} €`;

  document.getElementById('miete-ohne-steigerung').innerHTML =
    `Gesamte Mietzahlungen über ${zeitraum} Jahre: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ${miete_ohne_steigerung.toLocaleString('de-DE', {minimumFractionDigits: 2})} €`;

  document.getElementById('miete-mit-steigerung').innerHTML =
    `Gesamte Mietzahlungen über ${zeitraum} Jahre mit ${(average_rent_increase_rate*100).toFixed(1)}% Steigerung jährlich: ${miete_mit_steigerung.toLocaleString('de-DE', {maximumFractionDigits: 2})} €`;
}

// Initial output
updateMiete();

// Event Listener
document.getElementById('miete_zeitraum').addEventListener('input', updateMiete);
document.getElementById('miete_steigerung').addEventListener('input', updateMiete);
document.getElementById('miete_monat').addEventListener('input', updateMiete);
</script>


<!-- Visuelle Trennung -->
<hr style="margin: 2em 0; border: 0; border-top: 2px dashed #888;">


<!-- Neuer Abschnitt für zeitliche Dynamik -->
<div style="font-family:monospace;">
  <h3>Berechnung des Kaufpreis-Jahreseinkommens-Index & des Vervielfältiger-Index - Mit Dynamik</h3>
  <label>
    Zeitraum [Jahre]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="years" value="10" min="1" max="50" step="1"style="width: 3em;">
  </label><br>
  <label>
    Mietsteigerung pro Jahr [%]:&nbsp;&nbsp;&nbsp;
    <input type="number" id="average_rent_increase_rate" value="2" min="0" max="10" step="0.1"style="width: 3em;">
  </label><br>
  <label>
    Gehaltssteigerung pro Jahr [%]: 
    <input type="number" id="average_salary_increase_rate" value="2" min="0" max="50" step="0.1"style="width: 3em;">
  </label><br><br>
  <div id="dynamik-kaltmiete"></div>
  <div id="dynamik-vervielfaeltiger"></div>
  <div id="dynamik-einkommen-index"></div>
</div>
<script>
  // ...existing updateOutput() and event listeners...

  function updateDynamik() {
    const housing_cost = Number(document.getElementById('housing_cost').value);
    const cold_rent_per_month = Number(document.getElementById('cold_rent_per_month').value);
    const netto_income_per_anno = Number(document.getElementById('netto_income_per_anno').value);
    const years = Number(document.getElementById('years').value);
    const average_rent_increase_rate = Number(document.getElementById('average_rent_increase_rate').value) / 100;
    const average_salary_increase_rate = Number(document.getElementById('average_salary_increase_rate').value) / 100;

    // Berechnung wie im Notebook
    const kaltmiete_in_n_jahren = cold_rent_per_month * Math.pow(1 + average_rent_increase_rate, years);
    const vervielfaeltiger_in_n_jahren = cold_rent_per_month > 0
      ? (housing_cost) / (kaltmiete_in_n_jahren * 12)
      : '—';

    const netto_income_after_n_years = netto_income_per_anno * Math.pow(1 + average_salary_increase_rate, years);
    const cost_to_income_index = netto_income_after_n_years > 0
      ? housing_cost / netto_income_after_n_years
      : '—';
    // Ausgabe der Ergebnisse
    document.getElementById('dynamik-vervielfaeltiger').innerHTML =
      `Vervielfältiger nach ${years} Jahren mit ${(average_rent_increase_rate*100).toFixed(1)}% Mietsteigerung: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${typeof vervielfaeltiger_in_n_jahren === 'number' ? vervielfaeltiger_in_n_jahren.toFixed(2) : '—'}`;

    document.getElementById('dynamik-einkommen-index').innerHTML =
      `Kaufpreis-Jahreseinkommens Index nach ${years} Jahren mit ${(average_salary_increase_rate*100).toFixed(1)}% Gehaltssteigerung: ${typeof cost_to_income_index === 'number' ? cost_to_income_index.toFixed(2) : '—'}`;
  }

  // Initial output für Dynamik
  updateDynamik();

  // Event Listener für Dynamik
  document.getElementById('years').addEventListener('input', updateDynamik);
  document.getElementById('average_rent_increase_rate').addEventListener('input', updateDynamik);
  document.getElementById('average_salary_increase_rate').addEventListener('input', updateDynamik);
  document.getElementById('housing_cost').addEventListener('input', updateDynamik);
  document.getElementById('cold_rent_per_month').addEventListener('input', updateDynamik);
  document.getElementById('netto_income_per_anno').addEventListener('input', updateDynamik);
</script>

<!-- START INSERT INFLATION  -->
<!-- Visuelle Trennung -->
<hr style="margin: 2em 0; border: 0; border-top: 2px dashed #888;">

<!-- Inflation Chart Section (from inflation.html) -->
<div style="font-family: Arial, sans-serif;">
  <h3 style="text-align:left;">Purchasing Power since 2002</h3>
  <p style="max-width:900px; margin:0 0 1em 0;">
    How to read this plot:<br>
    If you´ve earned 1000€ in 2002, you would need to earn ~ 1500€ 2024 in order to "compensate" inflation.
    1000€ in 2002 is equivalent in purchasing power to about ~ 1500€ today.
  </p>
  <div id="chart-container" style="width: 90vw; max-width: 900px; margin: 40px 0;">
      <canvas id="devaluationChart"></canvas>
  </div>
</div>
<!-- Load your data exported from Python -->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Chart.js expects labels and data arrays
    const ctx = document.getElementById('devaluationChart').getContext('2d');
    const years1 = [2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023];
    const devaluation_ger = [1000, 1014.0, 1024.14, 1040.5262400000001, 1057.1746598400002, 1074.0894543974402, 1098.7935118485814, 1127.3621431566446, 1130.7442295861144, 1142.0516718819756, 1167.176808663379, 1189.3531680279832, 1207.1934655484029, 1219.2654002038869, 1225.3617272049062, 1231.4885358409306, 1249.9608638785444, 1272.460159428358, 1290.274601660355, 1296.7259746686568, 1336.9244798833852, 1429.1722689953388, 1513.4934328660636];
    const devaluation_us = [1000, 1016.0, 1039.368, 1067.4309359999997, 1103.7235878239999, 1139.0427426343679, 1172.0749821707645, 1216.6138314932537, 1211.7473761672807, 1231.1353341859572, 1270.5316648799078, 1297.2128298423856, 1316.6710222900213, 1337.7377586466616, 1339.075496405308, 1356.4834778585769, 1384.9696308936068, 1419.5938716659468, 1445.146561355934, 1462.4883200922052, 1531.2252711365388, 1653.723292827462, 1721.5259478333878];
    const devaluation_swiss = [1000, 1006.0, 1012.0360000000001, 1020.132288, 1032.373875456, 1043.7299880860157, 1051.0360980026178, 1076.2609643546807, 1070.8796595329072, 1078.3758171496374, 1080.5325687839368, 1072.9688408024492, 1070.8229031208443, 1070.8229031208443, 1059.043851186515, 1054.807675781769, 1060.0817141606776, 1069.6224495881236, 1073.900939386476, 1066.3836328107707, 1072.7819346076353, 1102.819828776649, 1125.9790451809586];

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: years1,
            datasets: [
                {
                    label: 'Euro (Ger)',
                    data: devaluation_ger,
                    borderColor: 'darkblue',
                    backgroundColor: 'darkblue',
                    fill: false,
                    pointRadius: 3
                },
                {
                    label: 'USD',
                    data: devaluation_us,
                    borderColor: 'darkgreen',
                    backgroundColor: 'darkgreen',
                    fill: false,
                    pointRadius: 3
                },
                {
                    label: 'Swiss franc',
                    data: devaluation_swiss,
                    borderColor: 'red',
                    backgroundColor: 'red',
                    fill: false,
                    pointRadius: 3
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Purchasing power since 2002'
                },
                legend: {
                    display: true
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Year'
                    },
                    ticks: {
                        autoSkip: false,
                        maxRotation: 90,
                        minRotation: 90
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: '[Euro],[USD],[SF]'
                    },
                    beginAtZero: false
                }
            }
        }
    });
</script>

<!-- STOP INSERT INFLATION  -->


<!-- Inflation Chart Section 2 -->
<div style="font-family: Arial, sans-serif;">
  <h3 style="text-align:left;">Purchasing Power since 2002 (Alternative Data)</h3>
  <p style="max-width:900px; margin:0 0 1em 0;">
    How to read this plot:<br>
1000€ saved in 2002 will only have a purchasing power of ~€650. Resulting in a purchasing power loss of 350€.
  </p>
  <div id="chart-container2" style="width: 90vw; max-width: 900px; margin: 40px 0;">
      <canvas id="devaluationChart2"></canvas>
  </div>
</div>
<script>
    // Chart.js expects labels and data arrays
    const ctx2 = document.getElementById('devaluationChart2').getContext('2d');
    const years2 = [2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024];
    const deval_ger_perc = [100.0, 98.61932938856016, 97.64290038471302, 96.1052169140876, 94.59174893118859, 93.10211508975254, 91.00891015616085, 88.7026414777396, 88.4373294892718, 87.56171236561563, 85.67682227555346, 84.07931528513589, 82.83676382772009, 82.01659784922782, 81.60855507385853, 81.2025423620483, 80.00250479019537, 78.58792219076167, 77.50288184493262, 77.11729536809216, 74.79854060920675, 69.97057119663869, 66.0723051904048];
    const deval_us_perc = [100.0, 98.4251968503937, 96.21231363674849, 93.68287598514948, 90.60239456977705, 87.79301799397, 85.31877356070943, 82.19535025116515, 82.52545205940275, 81.22583864114445, 78.70720798560508, 77.08835258139578, 75.9491158437397, 74.75306677533435, 74.67838838694742, 73.72002802265294, 72.20374928761308, 70.44268223181764, 69.19713382300357, 68.37661444960827, 65.30717712474524, 60.46960844883818, 58.0880004311606];
    const deval_swiss_perc = [100.0, 99.40357852882704, 98.81071424336683, 98.02650222556234, 96.86413263395488, 95.81022021162701, 95.1442107364717, 92.91426829733565, 93.38117416817654, 92.73204981944046, 92.5469559076252, 93.19935136719558, 93.38612361442442, 93.38612361442442, 94.42479637454441, 94.80401242424139, 94.33235067088697, 93.49093228036371, 93.11845844657739, 93.77488262495206, 93.21558909040961, 90.67664308405604, 88.81159949466802];

    new Chart(ctx2, {
        type: 'line',
        data: {
            labels: years2,
            datasets: [
                {
                    label: 'Euro (Ger)',
                    data: deval_ger_perc,
                    borderColor: 'darkblue',
                    backgroundColor: 'darkblue',
                    fill: false,
                    pointRadius: 3
                },
                {
                    label: 'USD',
                    data: deval_us_perc,
                    borderColor: 'darkgreen',
                    backgroundColor: 'darkgreen',
                    fill: false,
                    pointRadius: 3
                },
                {
                    label: 'Swiss franc',
                    data: deval_swiss_perc,
                    borderColor: 'red',
                    backgroundColor: 'red',
                    fill: false,
                    pointRadius: 3
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Purchasing power since 2002'
                },
                legend: {
                    display: true
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Year'
                    },
                    ticks: {
                        autoSkip: false,
                        maxRotation: 90,
                        minRotation: 90
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: '[Euro],[USD],[SF]'
                    },
                    beginAtZero: false
                }
            }
        }
    });
</script>

<!-- Inflation Chart Section 3 -->
<div style="font-family: Arial, sans-serif;">
  <h3 style="text-align:left;">Purchasing Power since 2002 (Plot 3)</h3>
  <p style="max-width:900px; margin:0 0 1em 0;">
    1000€ saved in 2002 (representing 100%) will only have a purchasing power of 65% of 2002.
  </p>
  <div id="chart-container3" style="width: 90vw; max-width: 900px; margin: 40px 0;">
      <canvas id="devaluationChart3"></canvas>
  </div>
</div>

<script>
    // Chart.js expects labels and data arrays
    const ctx3 = document.getElementById('devaluationChart3').getContext('2d');
    const years3 = [2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024];
    const deval_ger = [1000.0, 986.1932938856016, 976.4290038471302, 961.0521691408761, 945.9174893118859, 931.0211508975254, 910.0891015616085, 887.0264147773961, 884.373294892718, 875.6171236561564, 856.7682227555347, 840.7931528513589, 828.367638277201, 820.1659784922781, 816.0855507385853, 812.025423620483, 800.0250479019538, 785.8792219076167, 775.0288184493262, 771.1729536809216, 747.9854060920675, 699.7057119663868, 660.723051904048];
    const deval_us = [1000.0, 984.2519685039371, 962.1231363674849, 936.8287598514947, 906.0239456977704, 877.9301799397, 853.1877356070943, 821.9535025116514, 825.2545205940276, 812.2583864114445, 787.0720798560508, 770.8835258139578, 759.491158437397, 747.5306677533434, 746.7838838694742, 737.2002802265293, 722.0374928761307, 704.4268223181764, 691.9713382300357, 683.7661444960827, 653.0717712474524, 604.6960844883819, 580.8800043116061];
    const deval_swiss = [1000.0, 994.0357852882704, 988.1071424336683, 980.2650222556233, 968.6413263395489, 958.1022021162701, 951.4421073647171, 929.1426829733565, 933.8117416817654, 927.3204981944046, 925.469559076252, 931.9935136719557, 933.8612361442442, 933.8612361442442, 944.2479637454442, 948.0401242424139, 943.3235067088697, 934.909322803637, 931.184584465774, 937.7488262495207, 932.155890904096, 906.7664308405604, 888.1159949466802];

    new Chart(ctx3, {
        type: 'line',
        data: {
            labels: years3,
            datasets: [
                {
                    label: 'Euro (Ger)',
                    data: deval_ger,
                    borderColor: 'darkblue',
                    backgroundColor: 'darkblue',
                    fill: false,
                    pointRadius: 3
                },
                {
                    label: 'USD',
                    data: deval_us,
                    borderColor: 'darkgreen',
                    backgroundColor: 'darkgreen',
                    fill: false,
                    pointRadius: 3
                },
                {
                    label: 'Swiss franc',
                    data: deval_swiss,
                    borderColor: 'red',
                    backgroundColor: 'red',
                    fill: false,
                    pointRadius: 3
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Purchasing power since 2002'
                },
                legend: {
                    display: true
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Year'
                    },
                    ticks: {
                        autoSkip: false,
                        maxRotation: 90,
                        minRotation: 90
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: '[Euro],[USD],[SF]'
                    },
                    beginAtZero: false
                }
            }
        }
    });
</script>