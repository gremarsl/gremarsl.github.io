<style>
  /* Responsive input fields for mobile */
  input[type="number"] {
    min-width: 120px;
    width: 100%;
    max-width: 400px;
    box-sizing: border-box;
    font-size: 1.1em;
    padding: 0.2em;
    margin-top: 0.2em;
    margin-bottom: 0.6em;
  }
  label {
    display: block;
    margin-bottom: 0.2em;
  }
  @media (max-width: 600px) {
    div[style*="font-family:monospace;"] {
      font-size: 1em;
    }
    input[type="number"] {
      font-size: 1.2em;
      min-width: 120px;
      max-width: 100%;
    }
  }
</style>

<!-- Einleitung und Beschreibung -->
<div style="font-family:monospace; margin-bottom:2em;">
  <h2>Miet- und Kaufrechner</h2>
  <p>
    Diese Webseite ist ein Versuch, verschiedene Mietkosten- und Immobilienkauf-Szenarien zu berechnen.<br>
    Die Interpretation der Ergebnisse bleibt dir überlassen.<br>
  </p>
</div>
<!-- Financial Input Parameters and Index Calculation -->
<div style="font-family:monospace;">
  <h3>Berechnung des Preis-Einkommens-Index & des Vervielfältiger-Index - Ohne Dynamik</h3>
  <p>
    Preis-Einkommens-Index (Kaufpreis/Jahresnettoeinkommen): <br> 
    Gibt an, wie viele Jahresnettoeinkommen benötigt werden, um den Kaufpreis der Immobilie zu decken. <br>
     <br>
    Vervielfältiger-Index: <br>
    Gibt an, wie viele Jahreskaltmieten dem Kaufpreis der Immobilie entsprechen.
  </p>
  <label>
    Kaufpreis der Immobilie [€]:
    <input type="number" id="housing_cost" value="500000" min="0" step="1" style="width:8em;">
  </label><br>
  <label>
    Jah­res­net­to­ein­kom­men [€]:&nbsp;&nbsp;&nbsp;
    <input type="number" id="netto_income_per_anno" value="20000" min="0" step="1" style="width:8em;">
  </label><br>
  <label>
    Monatskaltmiete [€]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="cold_rent_per_month" value="1000" min="0" step="1" style="width:8em;">
  </label><br><br>
  <div id="finanz-parameter"></div>
  <div id="index"></div>
  <div id="vervielfaeltiger"></div>
</div>

<script>
  function updateOutput() {
    const housing_cost = Number(document.getElementById('housing_cost').value);
    const netto_income_per_anno = Number(document.getElementById('netto_income_per_anno').value);
    const cold_rent_per_month = Number(document.getElementById('cold_rent_per_month').value);

    const index = netto_income_per_anno > 0 ? (housing_cost / netto_income_per_anno).toFixed(2) : '—';
    document.getElementById('index').innerHTML = `<br>Preis-Einkommens-Index (Kaufpreis / Jahresnettoeinkommen):&nbsp;${index}`;

    const vervielfaeltiger = cold_rent_per_month > 0 ? (housing_cost / (cold_rent_per_month * 12)).toFixed(2) : '—';
    document.getElementById('vervielfaeltiger').innerHTML = `Vervielfältiger-Index (Kaufpreis / Jahreskaltmiete): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${vervielfaeltiger}`;
  }

  // Initial output
  updateOutput();

  // Add event listeners
  document.getElementById('housing_cost').addEventListener('input', updateOutput);
  document.getElementById('netto_income_per_anno').addEventListener('input', updateOutput);
  document.getElementById('cold_rent_per_month').addEventListener('input', updateOutput);
</script>

<div style="font-family:monospace; margin-bottom:2em;">
<p>
  Und was sagen mir diese Indizes? <br>
  Die empirica AG veröffentlicht quartalsweise einen 
  <a href="https://www.empirica-institut.de/fileadmin/Redaktion/Publikationen_Referenzen/PDFs/Blasenindex__2025Q1.pdf" target="_blank" rel="noopener">
    Immobilien Blasenindex (Q12025)
  </a> für Deutschlands Großstädte. <br>
  Hier kannst du die Indizes vergleichen und dich davor schützen, dass du einen zu hohen Preis zahlst.<br>
</p>
</div>


<!-- Visuelle Trennung -->
<hr style="margin: 2em 0; border: 0; border-top: 2px dashed #888;">


<!-- Gesamte Mietzahlungen über X Jahre (mit und ohne Steigerung) -->
<div style="font-family:monospace;">
  <h3>Gesamte Mietzahlungen</h3>
  <p>
    Diese Berechnung zeigt die gesamten Mietzahlungen über einen bestimmten Zeitraum, <br> sowohl ohne als auch mit jährlicher Mietsteigerung.
  </p>
  <label>
    Monatsmiete [€]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="miete_monat" value="1000" min="0" step="1" style="width:4em;">
  </label><br>
  <label>
    Zeitraum [Jahre]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="miete_zeitraum" value="10" min="1" max="50" step="1" style="width:4em;">
  </label><br>
  <label>
    Mietsteigerung pro Jahr [%]:
    <input type="number" id="miete_steigerung" value="0" min="0" max="10" step="0.1" style="width:4em;">
  </label>
  <br><br>
  <div id="miete-kaltmiete-in-n-jahren"></div>
  <div id="miete-ohne-steigerung"></div>
  <div id="miete-mit-steigerung"></div>
</div>

<script>
function updateMiete() {
  // Input-Parameter
  const cold_rent_per_month = Number(document.getElementById('miete_monat').value);
  const zeitraum = Number(document.getElementById('miete_zeitraum').value);
  const average_rent_increase_rate = Number(document.getElementById('miete_steigerung').value) / 100;

  // Jahresmiete
  const miete = cold_rent_per_month * 12;

  // Kaltmiete in n Jahren
  const kaltmiete_in_n_jahren = cold_rent_per_month * Math.pow(1 + average_rent_increase_rate, zeitraum);

  // Gesamte Mietzahlungen ohne Steigerung
  const miete_ohne_steigerung = miete * zeitraum;

  // Gesamte Mietzahlungen mit Steigerung
  let miete_mit_steigerung = 0;
  for (let i = 0; i < zeitraum; i++) {
    miete_mit_steigerung += miete * Math.pow(1 + average_rent_increase_rate, i);
  }

  document.getElementById('miete-kaltmiete-in-n-jahren').innerHTML =
    `Kaltmiete in ${zeitraum} Jahren: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ${kaltmiete_in_n_jahren.toLocaleString('de-DE', {maximumFractionDigits: 2})} €`;

  document.getElementById('miete-ohne-steigerung').innerHTML =
    `Gesamte Mietzahlungen über ${zeitraum} Jahre: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ${miete_ohne_steigerung.toLocaleString('de-DE', {minimumFractionDigits: 2})} €`;

  document.getElementById('miete-mit-steigerung').innerHTML =
    `Gesamte Mietzahlungen über ${zeitraum} Jahre mit ${(average_rent_increase_rate*100).toFixed(1)}% Steigerung jährlich: ${miete_mit_steigerung.toLocaleString('de-DE', {maximumFractionDigits: 2})} €`;
}

// Initial output
updateMiete();

// Event Listener
document.getElementById('miete_zeitraum').addEventListener('input', updateMiete);
document.getElementById('miete_steigerung').addEventListener('input', updateMiete);
document.getElementById('miete_monat').addEventListener('input', updateMiete);
</script>


<!-- Visuelle Trennung -->
<hr style="margin: 2em 0; border: 0; border-top: 2px dashed #888;">


<!-- Neuer Abschnitt für zeitliche Dynamik -->
<div style="font-family:monospace;">
  <h3>Berechnung des Kaufpreis-Jahreseinkommens-Index & des Vervielfältiger-Index - Mit Dynamik</h3>
  <label>
    Zeitraum [Jahre]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="number" id="years" value="10" min="1" max="50" step="1"style="width: 3em;">
  </label><br>
  <label>
    Mietsteigerung pro Jahr [%]:&nbsp;&nbsp;&nbsp;
    <input type="number" id="average_rent_increase_rate" value="2" min="0" max="10" step="0.1"style="width: 3em;">
  </label><br>
  <label>
    Gehaltssteigerung pro Jahr [%]: 
    <input type="number" id="average_salary_increase_rate" value="2" min="0" max="50" step="0.1"style="width: 3em;">
  </label><br><br>
  <div id="dynamik-kaltmiete"></div>
  <div id="dynamik-vervielfaeltiger"></div>
  <div id="dynamik-einkommen-index"></div>
</div>
<script>
  // ...existing updateOutput() and event listeners...

  function updateDynamik() {
    const housing_cost = Number(document.getElementById('housing_cost').value);
    const cold_rent_per_month = Number(document.getElementById('cold_rent_per_month').value);
    const netto_income_per_anno = Number(document.getElementById('netto_income_per_anno').value);
    const years = Number(document.getElementById('years').value);
    const average_rent_increase_rate = Number(document.getElementById('average_rent_increase_rate').value) / 100;
    const average_salary_increase_rate = Number(document.getElementById('average_salary_increase_rate').value) / 100;

    // Berechnung wie im Notebook
    const kaltmiete_in_n_jahren = cold_rent_per_month * Math.pow(1 + average_rent_increase_rate, years);
    const vervielfaeltiger_in_n_jahren = cold_rent_per_month > 0
      ? (housing_cost) / (kaltmiete_in_n_jahren * 12)
      : '—';

    const netto_income_after_n_years = netto_income_per_anno * Math.pow(1 + average_salary_increase_rate, years);
    const cost_to_income_index = netto_income_after_n_years > 0
      ? housing_cost / netto_income_after_n_years
      : '—';
    // Ausgabe der Ergebnisse
    document.getElementById('dynamik-vervielfaeltiger').innerHTML =
      `Vervielfältiger nach ${years} Jahren mit ${(average_rent_increase_rate*100).toFixed(1)}% Mietsteigerung: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${typeof vervielfaeltiger_in_n_jahren === 'number' ? vervielfaeltiger_in_n_jahren.toFixed(2) : '—'}`;

    document.getElementById('dynamik-einkommen-index').innerHTML =
      `Kaufpreis-Jahreseinkommens Index nach ${years} Jahren mit ${(average_salary_increase_rate*100).toFixed(1)}% Gehaltssteigerung: ${typeof cost_to_income_index === 'number' ? cost_to_income_index.toFixed(2) : '—'}`;
  }

  // Initial output für Dynamik
  updateDynamik();

  // Event Listener für Dynamik
  document.getElementById('years').addEventListener('input', updateDynamik);
  document.getElementById('average_rent_increase_rate').addEventListener('input', updateDynamik);
  document.getElementById('average_salary_increase_rate').addEventListener('input', updateDynamik);
  document.getElementById('housing_cost').addEventListener('input', updateDynamik);
  document.getElementById('cold_rent_per_month').addEventListener('input', updateDynamik);
  document.getElementById('netto_income_per_anno').addEventListener('input', updateDynamik);
</script>

<!-- START INSERT INFLATION  -->
 <script src="data.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- START INSERT INFLATION 1  -->
<!-- Visuelle Trennung -->
<hr style="margin: 2em 0; border: 0; border-top: 2px dashed #888;">

<!-- Inflation Chart Section (from inflation.html) -->
<div style="font-family: Arial, sans-serif;">
  <h3 style="text-align:left;">Currencies devaluation since 2002</h3>
  <h2 style="text-align:left;">Purchasing power - Inflation adjusted - Plot 1</h2>
  <label>
    Starting value [e.g. €]:
    <input type="number" id="base_input1" value="1000" min="1" step="1" style="width:8em;">
  </label>
  <p style="max-width:900px; margin:0 0 1em 0;">
    How to read this plot:<br>
    If you´ve earned <span id="base-value">1000</span>€ in <span id="year-start">2002</span>, you would need to earn ~ <span id="final-value">1500</span>€ in <span id="year-end">2023</span> in order to "compensate" inflation.
  </p>
<!-- Eingabefeld für Startwert -->

<!-- Plot-Container -->
<div id="chart-container1" style="width: 90vw; max-width: 900px; margin: 40px 0;">
    <canvas id="devaluationChart1"></canvas>
</div>

<script>
function calculateDevaluation(base) {
  // Annahme: inflation_rate_germany, inflation_rate_us, inflation_rate_switzerland, years aus data.js
  const devaluation_ger = [base];
  for (let i = 0; i < inflation_rate_germany.length; i++) {
    devaluation_ger.push(devaluation_ger[i] * (1 + inflation_rate_germany[i]/100));
  }
  devaluation_ger.length = years.length;

  const devaluation_us = [base];
  for (let i = 0; i < inflation_rate_us.length; i++) {
    devaluation_us.push(devaluation_us[i] * (1 + inflation_rate_us[i]/100));
  }
  devaluation_us.length = years.length;

  const devaluation_swiss = [base];
  for (let i = 0; i < inflation_rate_switzerland.length; i++) {
    devaluation_swiss.push(devaluation_swiss[i] * (1 + inflation_rate_switzerland[i]/100));
  }
  devaluation_swiss.length = years.length;

  return { devaluation_ger, devaluation_us, devaluation_swiss };
}

// Initialisierung Chart
let chart1;
function updateChart() {
  const base = Number(document.getElementById('base_input1').value);
  const { devaluation_ger, devaluation_us, devaluation_swiss } = calculateDevaluation(base);

  const ctx1 = document.getElementById('devaluationChart1').getContext('2d');
  if (chart1) chart1.destroy();
  chart1 = new Chart(ctx1, {
    type: 'line',
    data: {
      labels: years,
      datasets: [
        {
          label: 'Euro (Ger)',
          data: devaluation_ger,
          borderColor: 'darkblue',
          backgroundColor: 'darkblue',
          fill: false,
          pointRadius: 3
        },
        {
          label: 'USD',
          data: devaluation_us,
          borderColor: 'darkgreen',
          backgroundColor: 'darkgreen',
          fill: false,
          pointRadius: 3
        },
        {
          label: 'Swiss franc',
          data: devaluation_swiss,
          borderColor: 'red',
          backgroundColor: 'red',
          fill: false,
          pointRadius: 3
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'Purchasing power since 2002'
        },
        legend: {
          display: true
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: 'Year'
          },
          ticks: {
            autoSkip: false,
            maxRotation: 90,
            minRotation: 90
          }
        },
        y: {
          title: {
            display: true,
            text: '[Euro],[USD],[SF]'
          },
          beginAtZero: false
        }
      }
    }
  });
  // Dynamische Beschreibung aktualisieren
  document.getElementById('base-value').textContent = base.toLocaleString('de-DE');
  document.getElementById('final-value').textContent = devaluation_ger[devaluation_ger.length - 1].toLocaleString('de-DE', {maximumFractionDigits: 0});
  const yearStart = years[0];
  const yearEnd = years[years.length - 1];

}

// Initial anzeigen
updateChart();
// Event Listener für das Eingabefeld
document.getElementById('base_input1').addEventListener('input', updateChart);
</script>

<!-- STOP INSERT INFLATION 1 -->

<!-- START INSERT INFLATION 2  -->
<!-- Visuelle Trennung -->
<hr style="margin: 2em 0; border: 0; border-top: 2px dashed #888;">

<div style="font-family: Arial, sans-serif;">
  <h3 style="text-align:left;">Currencies devaluation since 2002</h3>
  <h2 style="text-align:left;">Purchasing power loss - Plot 2</h2>
  <label>
    Starting value [e.g. €]:
    <input type="number" id="base_input2" value="1000" min="1" step="1" style="width:8em;">
  </label>
  <p style="max-width:900px; margin:0 0 1em 0;">
    How to read this plot:<br>
    <span id="base-value-2">1000</span>€ saved in <span id="year-start-2">2002</span> will only have a purchasing power of <span id="final-value-2">500</span>€ in <span id="year-end-2">2023</span>. Resulting in a purchaing power loss of <span id="loss-value-2">500</span> €.
    </p>
<!-- Eingabefeld für Startwert -->

<!-- Plot-Container -->
<div id="chart-container2" style="width: 90vw; max-width: 900px; margin: 40px 0;">
    <canvas id="devaluationChart2"></canvas>
</div>

<script>
function calculateDevaluation2(base) {
  // Annahme: inflation_rate_germany, inflation_rate_us, inflation_rate_switzerland, years aus data.js
  const devaluation_ger = [base];
  for (let i = 0; i < inflation_rate_germany.length; i++) {
    devaluation_ger.push(devaluation_ger[i] * (1 + inflation_rate_germany[i]/100));
  }
  devaluation_ger.length = years.length;

  const devaluation_us = [base];
  for (let i = 0; i < inflation_rate_us.length; i++) {
    devaluation_us.push(devaluation_us[i] * (1 + inflation_rate_us[i]/100));
  }
  devaluation_us.length = years.length;

  const devaluation_swiss = [base];
  for (let i = 0; i < inflation_rate_switzerland.length; i++) {
    devaluation_swiss.push(devaluation_swiss[i] * (1 + inflation_rate_switzerland[i]/100));
  }
  devaluation_swiss.length = years.length;

  const deval_ger = devaluation_ger.map(x => base * base / x);
  const deval_us = devaluation_us.map(x => base * base / x);
  const deval_swiss = devaluation_swiss.map(x => base * base / x);

  return { deval_ger, deval_us, deval_swiss };
}

// Initialisierung Chart
let chart2;
function updateChart2() {
  const base = Number(document.getElementById('base_input2').value);
  const { deval_ger, deval_us, deval_swiss } = calculateDevaluation2(base);

  const ctx2 = document.getElementById('devaluationChart2').getContext('2d');
  if (chart2) chart2.destroy();
  chart2 = new Chart(ctx2, {
    type: 'line',
    data: {
      labels: years,
      datasets: [
        {
          label: 'Euro (Ger)',
          data: deval_ger,
          borderColor: 'darkblue',
          backgroundColor: 'darkblue',
          fill: false,
          pointRadius: 3
        },
        {
          label: 'USD',
          data: deval_us,
          borderColor: 'darkgreen',
          backgroundColor: 'darkgreen',
          fill: false,
          pointRadius: 3
        },
        {
          label: 'Swiss franc',
          data: deval_swiss,
          borderColor: 'red',
          backgroundColor: 'red',
          fill: false,
          pointRadius: 3
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'Purchasing power since 2002'
        },
        legend: {
          display: true
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: 'Year'
          },
          ticks: {
            autoSkip: false,
            maxRotation: 90,
            minRotation: 90
          }
        },
        y: {
          title: {
            display: true,
            text: '[Euro],[USD],[SF]'
          },
          beginAtZero: false
        }
      }
    }
  });
  // Dynamische Beschreibung aktualisieren
  document.getElementById('base-value-2').textContent = base.toLocaleString('de-DE');
  const finalValue = deval_ger[deval_ger.length - 1];

  document.getElementById('final-value-2').textContent = deval_ger[deval_ger.length - 1].toLocaleString('de-DE', {maximumFractionDigits: 0});
  document.getElementById('year-start-2').textContent = years[0];
  document.getElementById('year-end-2').textContent = years[years.length - 1];
  const loss = base - finalValue;
  document.getElementById('loss-value-2').textContent = loss.toLocaleString('de-DE', {maximumFractionDigits: 0});
}

// Initial anzeigen
updateChart2();
// Event Listener für das Eingabefeld
document.getElementById('base_input2').addEventListener('input', updateChart2);
</script>

<!-- STOP INSERT INFLATION 2  -->
