<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Development of a Runtime Measurement System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navmenu">
        <div class="navlink">
            <a href="index.html">Home</a>
            <a href="housing.html">Housing Calculator</a>
            <a href="inflation.html">Inflation Calculator</a>
            <a href="tax.html">Bruttoverdienst-Analyse</a>
            <a href="social.html">Sozialversicherungsbeitr√§ge-Analyse</a>
            <a href="fpga.html" class="current">Development of a Runtime Measurement System</a>
        </div>
    </nav>

    <h2>Development of a runtime measurement system</h2>
    
    <p>I am developing a system designed to accurately measure and analyze runtime of various software or hardware processes. The idea for this system arose from the need for precise timing and measurement solutions within the context of embedded systems development.</p>
    
    <p>Software Based measurements are popular and easy to realize. Though change the system under test since you add measurement code. Accuracy is limited and dependent on the speed the embedded system is clocked and the overhead introduced by the software-defined runtime measurement.<br>
    Resulting in changing the time behaviour of the system. This is not what you want.<br>
    <br>
    To reduce the intrusiveness, changing the measurement methodology using external hardware can be useful.</p>
    
    <p>Another driving factor for developing this system was personal interest. I'm fascinated by embedded hardware, but my prior work was always focused on one goal: Writing and running software on it. Though that often meant an odyssey through compiler issues and hardware reference manuals!</p>
    
    <p>My long-term aspiration has been to get even closer to the metal, and that's where FPGAs come in. This is the perfect intersection: I can realize the high-precision runtime measurement feature using an FPGA. Not only are FPGAs inherently fast due to their independence from a main CPU, but the project also gives me a valuable opportunity to learn new skills.</p>
    
    <h2>System Runtime Measurement</h2>
    
    <svg width="700" height="250" style="border: 1px solid #ccc; background: white; display: block; margin: 20px auto;">
        <!-- System A Box -->
        <rect x="200" y="30" width="300" height="80" fill="#e8f4f8" stroke="#333" stroke-width="2"/>
        <text x="350" y="75" text-anchor="middle" font-size="18" font-weight="bold">System A</text>
        
        <!-- Event A (entering) -->
        <circle cx="150" cy="70" r="8" fill="#228B22"/>
        <text x="150" y="55" text-anchor="middle" font-size="14" font-weight="bold">Event A</text>
        <line x1="158" y1="70" x2="200" y2="70" stroke="#228B22" stroke-width="2" marker-end="url(#arrowgreen)"/>
        
        <!-- Event B (exiting) -->
        <circle cx="550" cy="70" r="8" fill="#B22222"/>
        <text x="550" y="55" text-anchor="middle" font-size="14" font-weight="bold">Event B</text>
        <line x1="500" y1="70" x2="542" y2="70" stroke="#B22222" stroke-width="2" marker-end="url(#arrowred)"/>
        
        <!-- Arrow markers -->
        <defs>
            <marker id="arrowgreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="#228B22"/>
            </marker>
            <marker id="arrowred" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="#B22222"/>
            </marker>
        </defs>
        
        <!-- Timing Diagram -->
        <text x="50" y="160" font-size="16" font-weight="bold">Signal:</text>
        
        <!-- Time axis -->
        <line x1="150" y1="200" x2="550" y2="200" stroke="#333" stroke-width="1"/>
        
        <!-- Signal waveform -->
        <!-- LOW state -->
        <line x1="150" y1="200" x2="200" y2="200" stroke="#0066cc" stroke-width="3"/>
        <!-- Rising edge at t1 -->
        <line x1="200" y1="200" x2="200" y2="160" stroke="#0066cc" stroke-width="3"/>
        <!-- HIGH state -->
        <line x1="200" y1="160" x2="500" y2="160" stroke="#0066cc" stroke-width="3"/>
        <!-- Falling edge at t2 -->
        <line x1="500" y1="160" x2="500" y2="200" stroke="#0066cc" stroke-width="3"/>
        <!-- LOW state -->
        <line x1="500" y1="200" x2="550" y2="200" stroke="#0066cc" stroke-width="3"/>
        
        <!-- Time markers -->
        <line x1="200" y1="200" x2="200" y2="210" stroke="#333" stroke-width="2"/>
        <text x="200" y="225" text-anchor="middle" font-size="14" font-weight="bold">t1</text>
        
        <line x1="500" y1="200" x2="500" y2="210" stroke="#333" stroke-width="2"/>
        <text x="500" y="225" text-anchor="middle" font-size="14" font-weight="bold">t2</text>
        
        <!-- Labels -->
        <text x="175" y="205" text-anchor="end" font-size="12">LOW</text>
        <text x="175" y="165" text-anchor="end" font-size="12">HIGH</text>
        
        <!-- Runtime measurement arrow -->
        <line x1="200" y1="145" x2="500" y2="145" stroke="#666" stroke-width="1" stroke-dasharray="5,5" marker-end="url(#arrowgray)" marker-start="url(#arrowgray2)"/>
        <text x="350" y="140" text-anchor="middle" font-size="13" font-style="italic">Runtime (t2 - t1)</text>
        
        <marker id="arrowgray" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
            <path d="M0,0 L0,6 L7,3 z" fill="#666"/>
        </marker>
        <marker id="arrowgray2" markerWidth="8" markerHeight="8" refX="0" refY="3" orient="auto">
            <path d="M7,0 L7,6 L0,3 z" fill="#666"/>
        </marker>
    </svg>
    
    <h2>Highlevel system design diagram</h2>
    
    <pre class="mermaid">
    graph TD
    I(Measurement Input Signal) --- F(FPGA)
    O(Oscillator) --- F(FPGA)
    F(FPGA) ---|UART| S(Smaller CPU)
    S --- |USB/ ETH| L(Larger CPU)

    style F fill:#FFFFED,stroke:#FCE992
    style I fill:none,stroke:#228B22
    linkStyle 0 stroke:#228B22
    </pre>

    <h2>FPGA focused system design diagram</h2>
    
    <pre class="mermaid">
    graph TD
    I(Measurement Input Signal) --- F
    Hz(1Hz Debug Pin) --- F
    D(Debug Pin) --- F
    O(optional external Oscillator) --- F
    
    subgraph F[FPGA]
        direction TB
        subgraph Left[" "]
            direction TB
            RE[Rising & Falling Edge Detector] --- CC
            CC[ Clock Counter]
            CC --- DSM[Calulation & Measurement Data Storage Module]
            DSM --- U
            OO(Onboard Oscillator) --- CC
            RE --- DSM
        end
        subgraph U[UART]
            direction TB
            URX[UART RX]
            UTX[UART TX]
        end
        Left ~~~ U
    end
    
    F ---|UART| S(Smaller CPU - intermediate storage)
    S ---|USB/ ETH| L(Larger CPU - visualization)
    
    style I fill:none,stroke:#228B22
    style Hz fill:none,stroke:#000000
    style D fill:none,stroke:#000000
    style Left fill:none,stroke:none
    </pre>

    <h2>System Resolution</h2>

    <p>Resolution and accuracy depends on the clocking speed of the system. What is our accuracy if we use an oscillator with frequency f?</p>

    <div class="table-container">
        <table class="measurement-table">
            <thead>
                <tr>
                    <th>Frequency (f)</th>
                    <th>Period (T)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>12 MHz</td>
                    <td>83.33 ns</td>
                </tr>
                <tr>
                    <td>50 MHz</td>
                    <td>20 ns</td>
                </tr>
                <tr>
                    <td>100 MHz</td>
                    <td>10 ns</td>
                </tr>
                <tr>
                    <td>500 MHz</td>
                    <td>2 ns</td>
                </tr>
                <tr>
                    <td>1 GHz</td>
                    <td>1 ns</td>
                </tr>
            </tbody>
        </table>
    </div>
    <p>This means with a clocking oscillator of 100 MHz we can measure time events with a resolution of 10 ns.<br>
        Resolution: the smallest time increment you can distinguish (determined by clock period)<br>
        Accuracy: how close your measurement is to the true value (affected by clock stability, jitter, calibration, etc.)</p>

    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    </script>

    <div class="contact-section">
        <hr>
        <h3>Get in Touch</h3>
        <p>Interested in how this runtime measurement system could optimize your work? Let's discuss your specific use case!</p>
        <a href="mailto:sophia.wegers@gmail.com" class="contact-button">Contact Me</a>
    </div>

</body>
</html>